
## 第4章：ヘルプデスクエージェント
- 前提、AIが全ての質問に正確に回答することは困難
- 改善させるには、AIエージェントに回答させたい質問(情報)の範囲を明確にすること
### 原因①：計画の不備
- AIエージェントの場合、最初の計画が大事。最初の計画がずれていると、課題が解説されない。
- 現場特有の専門用語やアプローチを、LLMが理解していない可能性がある。
- 人間が業務にあたる場合、無意識に暗黙知的な情報を使用している可能性がある。
- 暗黙知をAIエージェントに組み込むことで、より人間らしい判断や対応が可能になる。

### 原因②：検索ツール(RAG)の改善
 よく課題になるのは以下2つのパターン。
 -  回答するために必要な情報が存在しないパターン
 - 必要な情報は存在するが到達できないパターン
 
 上記の課題の解決には検索ツール(RAG)の改善が必要 。
 RAGには以下の画像のように主に3つのステップで構成されている。
 1. データ準備(前処理)
 2. 検索
 3. 生成
![[IMG_1194.jpg]]
#### 1. データ準備(前処理)
データ準備の段階で考慮すべき主な点は以下2つ。
##### ドキュメントから必要な情報を漏れなく読み込めているか。
- 単純な構造化データで構成されている場合は簡単に情報が読み込めるが、画像や表といった構造化されていない複雑なデータの場合、情報の読み込みが難しくなる。
- そのため複雑なデータの場合、事前に検索可能な形式に変換する必要がある。
	- 例：画像内のテキストを抽出する。表データをマークダウンに変換する。
- よくある検索可能な形式に変換する方法としてあるのは光学文字認識(OCR)、もしくはLLMです。
	- LLMでは画像を入力してその内容をテキストで説明させたり、画像内の表をテキストとして出力させることが可能。
##### 検索インデックスの構築方法
- 検索インデックスの構築方法やデータの投入方法が適切でないと検索精度が低下する。以下画像でインデックス構築の際のポイント4点が上げられている。

![[IMG_1195.jpg]]
上記に加えて以下2つの方法がある。

##### HyDE手法の活用
- クエリからLLMで仮想的な回答を生成し、その回答をベクトル化します。これによって質問と回答のベクトル間の距離を縮め関連性の高い検索結果を得られる。

##### 埋め込みベクトルモデルの調整
- 特定のタスクに適した埋め込みモデルを選択し、必要に応じてファインチューニングを行う。これによって、ドメイン固有の概念や専門用語をより適切に表現できるベクトル空間を構築し、検索精度を向上させられる。

#### 2 & 3 検索・生成

仮に検索インデックスが適切に構築されていても、適切な検索結果が得られないことがある。これにはいくつかの原因があり、それぞれに対する解決策が以下の画像のように提案されている。

![[IMG_1196.jpg]]
### その他
- AIエージェントの場合、処理を複雑化させることでより高度なパターンを実現できる一方、間違った方向に進むリスクも高まる。
- プロンプトを複雑にして制御しようとすると、汎用性と保守性が低下する傾向がある。
- AIエージェントをシステムとして導入する場合、人による監視は必要。そのため、すべてのパターンを網羅しようとするよりも、以下のように対応するのがいい。
	- うまくいくパターンとそうでないパターンを区別し、前者をより確実かつ効率的に実行できるようにし、後者は人間が対処するアプローチも有効。
- AIエージェントの構成やプロンプトの最適化に加え、参照ドキュメントの運用も極めて重要。ドキュメントの更新プロセスも同時に設計することで、よりAIエージェントを有効に活用できる。
- AIエージェントの性能を最大限に引き出すためには、人による監視やAIエージェントが利用する検索システムの構成、参照するドキュメントの運用まで含めて設計し、これらの要素を総合的に考慮し、継続的な改善とメンテナンスを行うことが重要。

## 8章：AIエージェントの評価
- AIエージェントの評価は評価する観点が多く大変。
- 最終的な目標を達成できたかだけではなく、途中経過も詳細に評価する必要がある。
- また評価後はエラーを分析し、プロンプトやアーキテクチャを考え直す必要がある。

### AIエージェントの評価とは
- AIエージェントの評価の観点は以下2つある。
	- LLMが獲得しているAIエージェント能力の評価
	- AIエージェントの問題解決能力の評価

### AIエージェント能力の評価
- LLMのAIエージェント能力は、最終的にはAIエージェントが問題解決できるかが重要だが、そもそも問題解決できる道中でAIエージェントに必要な能力を発揮できているかを個別評価します。

#### 実務での評価方法は？
- AIエージェントの能力をPoCで評価するときは、GPT-4oなどの特定モデルで必要な能力を個別に評価し、精度が向上するようにプロンプトチューニングを行う。
- 上記評価のために能力別で評価用のデータセットを用意する。
- 評価データは入力と期待する結果のテストケースを用意し、人手で評価することが推奨。評価件数はまず数十件でも良し。
#### 問題解決能力の評価
- AIエージェントの問題解決能力を考える時、ドメイン空間とタスク空間を考える必要がある。

![[IMG_1204.jpg]]
- ドメイン空間とは、自分が取り組む問題設定の範囲のこと。
	- 何のための質問応答か定めた時点で取り組むドメイン空間はその範囲になる。
	- 業務上必要な範囲で区切るのが望ましい。
- タスク空間とは自分が解決するタスクの集合。
	- タスクは基本的に「質問に答える」、「操作を自動化する」など動詞で表すことができる。
	- たとえば質問は要約、翻訳、アイディア作成タスクにそれぞれ分解できる。

#### 1. 特定のドメインで特定タスクのみで評価(Distribution-specific)
- AIのPoCで多いのは基本的にこのケース。**特定の想定した範囲で想定タスクを解く**設定。
	- 例：自社のECサイトのナビゲーションをタスクとするのであれば、ホーム画面から商品購入まで導けるか、ホーム画面から購入履歴の確認までできるかを評価します。他社のECサイトでうまくいくかは興味の範囲外。

#### 2. 汎用ドメインで特定タスクで評価(Task-specific)
- 特化型のAIサービスとして売り出す場合に該当する。
	- 例：議事録サービス、社内ドキュメントの質疑応答サービス
- タスクを固定し、まったく異なる顧客データでも使えるように汎用的に作り込む。
	- 例：ECサイトのナビゲーションでは、別のECサイトでもうまくいくことを保証するように、様々なサイトで評価する。ドメインの汎用性を広げる場合、ECサイトに限らずホテルや自治体のHPのナビゲーションができるか評価する、というもの。
- チューニングしたのが社内のデータであれば異なる顧客のデータ(未知のドメイン)で評価する。

#### 3. 特定のドメインで汎用タスクで評価(Domain-general)
- AIエージェントが特定の職業を担うようなケース。
	- 会社専属の営業エージェントを作り、特定のタスクだけはなく、未知を含むさまざまなタスクをこなす。
- 評価する時は特定のドメインで未知のタスクに取り組む必要がある。

#### 4. 汎用ドメインで汎用タスクで評価(Fully-general)
- 一番難しい。飛躍した難しさになる。AGI(汎用人工知能)といえるAIエージェントはこのレベル。
- AIエージェントがある特定の職業を担うようなケース。特定だけではなく、未知を含む様々なタスクをこなします。

#### 実務で目指す問題解決は？
1. 特定のドメインで特定タスク(Domain-general)、2.汎用ドメインタスク(Task-specific)で役立つAIエージェントを目指すことが推奨。3. 特定のドメインで汎用タスク(Domain-general)は、タスクごとの精度の検証が増えて研究開発レベルの難易度だと考えられる。

## 評価指標

### AIエージェント能力に関する指標
#### 計画の妥当性
AIエージェントの計画が人間の考える行動計画と一致するか評価する。計画には以下の2種類がある。
- 行動を始める前の事前計画(正解データと見比べる)
- 行動しながらの逐次計画(実行履歴から計画を再構成して比較する)

人間が見比べるのが厳しい場合、LLMに正解データを渡して比較させる。

####  
